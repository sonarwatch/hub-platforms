# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a TypeScript package that maintains a comprehensive registry of platforms in the Solana DeFi ecosystem. The package exports structured platform data including metadata, links, token information, and standardized images.

## Development Commands

- **Build**: `npm run build` - Compiles TypeScript and generates index file
- **Build for CI**: `npm run build:ci` - Builds library and generates JSON output
- **Test**: `npm test` - Runs Jest test suite
- **Test with watch**: `npm test:watch` - Runs tests in watch mode
- **Lint**: `npm run lint` - Checks code formatting with Prettier
- **Format**: `npm run format` - Auto-formats code with Prettier

## Core Architecture

### Platform Definition Structure
Each platform is defined in `src/platforms/[platform-id].ts` with this structure:
- `id`: Unique platform identifier (kebab-case)
- `name`: Display name
- `description`: Optional description
- `defiLlamaId`: Optional DeFiLlama integration ID
- `links`: Object containing website, social media, and documentation URLs
- `tokens`: Array of Solana token addresses associated with the platform
- `tags`: Array of platform categories (dapp, dex, nft-marketplace, etc.)

### Auto-Generated Files
- `src/platforms/index.ts`: Auto-generated by `scripts/generate-imports.ts`
- `dist/platforms.json`: Auto-generated by `scripts/generate-json.ts`

### Key Scripts
- `scripts/generate-imports.ts`: Scans platform files and generates barrel export with proper naming conventions
- `scripts/generate-json.ts`: Creates JSON output for distribution
- Always run `npm run build:index` after adding new platform files

### Image Management
- All platform images are stored in `img/[platform-id].webp`
- Images are automatically referenced via GitHub raw URLs in the final platform objects
- Tests verify that every platform has a corresponding WebP image

### Publishing Workflow
Before publishing:
1. Run `npm run commit:index` to update auto-generated files
2. Use `npm version patch/minor/major` to bump version
3. Push tags: `git push origin main --tags`

## Testing Requirements
- Platform schema validation with Zod
- Duplicate ID detection
- Image file validation (WebP format)
- No orphaned images in img/ folder
- All platforms must have at least one tag
- All required links must be valid URLs